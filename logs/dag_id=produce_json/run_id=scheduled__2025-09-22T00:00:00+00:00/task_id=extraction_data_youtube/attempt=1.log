{"timestamp":"2025-09-22T00:00:00.849883","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-09-22T00:00:00.864784","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/produce_json.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-09-22T00:00:00.981592","level":"info","event":"file_cache is only supported with oauth2client<4.0.0","logger":"googleapiclient.discovery_cache"}
{"timestamp":"2025-09-22T00:00:01.783698Z","level":"info","event":"file created","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-22T00:00:01.784244Z","level":"info","event":"data :  MrBeast","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-22T00:00:01.784568Z","level":"info","event":"le fichier est en écriture","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-22T00:00:01.784901Z","level":"info","event":"le fichier est sauvegarder","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-22T00:00:01.783238","level":"info","event":"Done. Returned value was: {'status': 200, 'message': \"L'extraction a réussie avec succes\", 'data': {'channel_handle': 'MrBeast', 'extraction_date': '2025-09-22T00:00:01.782692', 'total_videos': 5, 'videos': [{'title': 'Which Celebrity Punches The Hardest?', 'duration': 'PT47S', 'video_id': '9Xeepzg1B8I', 'like_count': '1613379', 'view_count': '57081248', 'published_at': '2025-09-19T16:00:03Z', 'comment_count': '4519', 'duration_readable': '0:47'}, {'title': 'Answer The Call, Win $10,000', 'duration': 'PT39S', 'video_id': '50G0kIty7Cg', 'like_count': '2963576', 'view_count': '103842512', 'published_at': '2025-09-16T17:00:04Z', 'comment_count': '7524', 'duration_readable': '0:39'}, {'title': 'Survive 30 Days Chained To Your Ex, Win $250,000', 'duration': 'PT37M4S', 'video_id': '4l97aNza_Zc', 'like_count': '2721472', 'view_count': '102266158', 'published_at': '2025-09-13T16:00:01Z', 'comment_count': '38698', 'duration_readable': '37:04'}, {'title': 'I Arrested IShowSpeed', 'duration': 'PT35S', 'video_id': '3ih2bPKSWsQ', 'like_count': '1547637', 'view_count': '44659619', 'published_at': '2025-09-12T17:00:01Z', 'comment_count': '4569', 'duration_readable': '0:35'}, {'title': 'Survive 100 Days In Prison, Win $500,000', 'duration': 'PT39M36S', 'video_id': 'TDv56whosPQ', 'like_count': '2770861', 'view_count': '111072298', 'published_at': '2025-08-16T19:00:02Z', 'comment_count': '39043', 'duration_readable': '39:36'}]}}","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-09-22T00:00:01.783514","level":"info","event":"Pushing xcom","ti":"RuntimeTaskInstance(id=UUID('01996eb8-5e76-7849-9881-fcf2c9bfa7e3'), task_id='extraction_data_youtube', dag_id='produce_json', run_id='scheduled__2025-09-22T00:00:00+00:00', try_number=1, map_index=-1, hostname='68be7479792e', context_carrier=None, task=<Task(PythonOperator): extraction_data_youtube>, bundle_instance=LocalDagBundle(name=dags-folder), max_tries=0, start_date=datetime.datetime(2025, 9, 22, 0, 0, 0, 774311, tzinfo=datetime.timezone.utc), end_date=None, state=<TaskInstanceState.RUNNING: 'running'>, is_mapped=False, rendered_map_index=None, log_url='http://localhost:8080/dags/produce_json/runs/scheduled__2025-09-22T00%3A00%3A00%2B00%3A00/tasks/extraction_data_youtube?try_number=1')","logger":"task"}
{"timestamp":"2025-09-22T08:46:55.243546","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-09-22T08:46:55.244334","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/produce_json.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-09-22T08:46:55.955553","level":"info","event":"file_cache is only supported with oauth2client<4.0.0","logger":"googleapiclient.discovery_cache"}
{"timestamp":"2025-09-22T08:46:57.422093","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"TypeError","exc_value":"extract_data_youtube() missing 1 required positional argument: 'channel_handle'","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":920,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1215,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":216,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":239,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-09-22T10:13:48.692210","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-09-22T10:13:48.692881","level":"info","event":"Filling up the DagBag from dags/produce_json.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-09-22T10:13:48.779577","level":"info","event":"file_cache is only supported with oauth2client<4.0.0","logger":"googleapiclient.discovery_cache"}
{"timestamp":"2025-09-22T10:13:48.823197Z","level":"info","event":"Task instance is in running state","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-22T10:13:48.823348Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-22T10:13:48.823732Z","level":"info","event":"Current task name:extraction_data_youtube","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-22T10:13:48.823860Z","level":"info","event":"Dag name:produce_json","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-22T10:13:49.424733","level":"info","event":"Done. Returned value was: {'kind': 'youtube#searchListResponse', 'etag': 'txNFw5RiS8C8sarZmfIeD8rcPoo', 'nextPageToken': 'CAUQAA', 'regionCode': 'NL', 'pageInfo': {'totalResults': 145, 'resultsPerPage': 5}, 'items': [{'kind': 'youtube#searchResult', 'etag': '4g2pRzy5qXRS64JnRB9PA3_bqgQ', 'id': {'kind': 'youtube#video', 'videoId': '9Xeepzg1B8I'}, 'snippet': {'publishedAt': '2025-09-19T16:00:03Z', 'channelId': 'UCX6OQ3DkcsbYNE6H8uQQuVA', 'title': 'Which Celebrity Punches The Hardest?', 'description': '', 'thumbnails': {'default': {'url': 'https://i.ytimg.com/vi/9Xeepzg1B8I/default.jpg', 'width': 120, 'height': 90}, 'medium': {'url': 'https://i.ytimg.com/vi/9Xeepzg1B8I/mqdefault.jpg', 'width': 320, 'height': 180}, 'high': {'url': 'https://i.ytimg.com/vi/9Xeepzg1B8I/hqdefault.jpg', 'width': 480, 'height': 360}}, 'channelTitle': 'MrBeast', 'liveBroadcastContent': 'none', 'publishTime': '2025-09-19T16:00:03Z'}}, {'kind': 'youtube#searchResult', 'etag': 'LRRfIT7vMhVmA3IKyMbG0OP7-rE', 'id': {'kind': 'youtube#video', 'videoId': '50G0kIty7Cg'}, 'snippet': {'publishedAt': '2025-09-16T17:00:04Z', 'channelId': 'UCX6OQ3DkcsbYNE6H8uQQuVA', 'title': 'Answer The Call, Win $10,000', 'description': '', 'thumbnails': {'default': {'url': 'https://i.ytimg.com/vi/50G0kIty7Cg/default.jpg', 'width': 120, 'height': 90}, 'medium': {'url': 'https://i.ytimg.com/vi/50G0kIty7Cg/mqdefault.jpg', 'width': 320, 'height': 180}, 'high': {'url': 'https://i.ytimg.com/vi/50G0kIty7Cg/hqdefault.jpg', 'width': 480, 'height': 360}}, 'channelTitle': 'MrBeast', 'liveBroadcastContent': 'none', 'publishTime': '2025-09-16T17:00:04Z'}}, {'kind': 'youtube#searchResult', 'etag': 'x1McgQevyMDKDKD-b2LTPS7UjHI', 'id': {'kind': 'youtube#video', 'videoId': '4l97aNza_Zc'}, 'snippet': {'publishedAt': '2025-09-13T16:00:01Z', 'channelId': 'UCX6OQ3DkcsbYNE6H8uQQuVA', 'title': 'Survive 30 Days Chained To Your Ex, Win $250,000', 'description': \"I can't believe they chose to do that Sign up for Current ...\", 'thumbnails': {'default': {'url': 'https://i.ytimg.com/vi/4l97aNza_Zc/default.jpg', 'width': 120, 'height': 90}, 'medium': {'url': 'https://i.ytimg.com/vi/4l97aNza_Zc/mqdefault.jpg', 'width': 320, 'height': 180}, 'high': {'url': 'https://i.ytimg.com/vi/4l97aNza_Zc/hqdefault.jpg', 'width': 480, 'height': 360}}, 'channelTitle': 'MrBeast', 'liveBroadcastContent': 'none', 'publishTime': '2025-09-13T16:00:01Z'}}, {'kind': 'youtube#searchResult', 'etag': 'cCszJAny6rrj4u2MBM0A6sYOP3U', 'id': {'kind': 'youtube#video', 'videoId': '3ih2bPKSWsQ'}, 'snippet': {'publishedAt': '2025-09-12T17:00:01Z', 'channelId': 'UCX6OQ3DkcsbYNE6H8uQQuVA', 'title': 'I Arrested IShowSpeed', 'description': '', 'thumbnails': {'default': {'url': 'https://i.ytimg.com/vi/3ih2bPKSWsQ/default.jpg', 'width': 120, 'height': 90}, 'medium': {'url': 'https://i.ytimg.com/vi/3ih2bPKSWsQ/mqdefault.jpg', 'width': 320, 'height': 180}, 'high': {'url': 'https://i.ytimg.com/vi/3ih2bPKSWsQ/hqdefault.jpg', 'width': 480, 'height': 360}}, 'channelTitle': 'MrBeast', 'liveBroadcastContent': 'none', 'publishTime': '2025-09-12T17:00:01Z'}}, {'kind': 'youtube#searchResult', 'etag': 'o9cw13tYldyPdnNJDCv0FS8h8Sc', 'id': {'kind': 'youtube#video', 'videoId': 'TDv56whosPQ'}, 'snippet': {'publishedAt': '2025-08-16T19:00:02Z', 'channelId': 'UCX6OQ3DkcsbYNE6H8uQQuVA', 'title': 'Survive 100 Days In Prison, Win $500,000', 'description': 'I did not expect them to do that lol Get your hands on the new MrBeast Lab Hybrids here: ...', 'thumbnails': {'default': {'url': 'https://i.ytimg.com/vi/TDv56whosPQ/default.jpg', 'width': 120, 'height': 90}, 'medium': {'url': 'https://i.ytimg.com/vi/TDv56whosPQ/mqdefault.jpg', 'width': 320, 'height': 180}, 'high': {'url': 'https://i.ytimg.com/vi/TDv56whosPQ/hqdefault.jpg', 'width': 480, 'height': 360}}, 'channelTitle': 'MrBeast', 'liveBroadcastContent': 'none', 'publishTime': '2025-08-16T19:00:02Z'}}]}","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-09-22T10:13:49.425025","level":"info","event":"Pushing xcom","ti":"RuntimeTaskInstance(id=UUID('019970ea-4c50-79ae-a486-e1cdf00864fb'), task_id='extraction_data_youtube', dag_id='produce_json', run_id='scheduled__2025-09-22T00:00:00+00:00', try_number=1, map_index=-1, hostname='codespaces-c2d229', context_carrier=None, task=<Task(PythonOperator): extraction_data_youtube>, bundle_instance=LocalDagBundle(name=dags-folder), max_tries=0, start_date=datetime.datetime(2025, 9, 22, 10, 13, 47, 448719, tzinfo=datetime.timezone.utc), end_date=None, state=<TaskInstanceState.RUNNING: 'running'>, is_mapped=False, rendered_map_index=None, log_url='http://localhost:8080/dags/produce_json/runs/scheduled__2025-09-22T00%3A00%3A00%2B00%3A00/tasks/extraction_data_youtube?try_number=1')","logger":"task"}
{"timestamp":"2025-09-22T10:13:49.454427Z","level":"info","event":"Task instance in success state","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-22T10:13:49.454571Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.RUNNING","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-22T10:13:49.454745Z","level":"info","event":"Task operator:<Task(PythonOperator): extraction_data_youtube>","chan":"stdout","logger":"task"}
