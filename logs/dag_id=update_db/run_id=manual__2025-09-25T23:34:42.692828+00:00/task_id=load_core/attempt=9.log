{"timestamp":"2025-09-26T14:36:18.819573","level":"warning","event":"Could not import pandas. Holidays will not be considered.","logger":"airflow.example_dags.plugins.workday"}
{"timestamp":"2025-09-26T14:36:18.988629","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-09-26T14:36:18.997218","level":"info","event":"Filling up the DagBag from dags/update_db.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-09-26T14:36:19.646085Z","level":"info","event":"Task instance is in running state","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-26T14:36:19.646846Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-26T14:36:19.648176Z","level":"info","event":"Current task name:load_core","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-26T14:36:19.648523Z","level":"info","event":"Dag name:update_db","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-26T14:36:20.507360","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"IntegrityError","exc_value":"(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"youtube_videos_video_id_key\"\nDETAIL:  Key (video_id)=(9Xeepzg1B8I) already exists.\n\n[SQL: INSERT INTO youtube_videos (channel_handle, extraction_date, video_id, title, duration, duration_readable, view_count, like_count, comment_count, published_at) VALUES (%(channel_handle)s, %(extraction_date)s, %(video_id)s, %(title)s, %(duration)s, %(duration_readable)s, %(view_count)s, %(like_count)s, %(comment_count)s, %(published_at)s) RETURNING youtube_videos.id]\n[parameters: {'channel_handle': 'MrBeast', 'extraction_date': datetime.date(2025, 9, 22), 'video_id': '9Xeepzg1B8I', 'title': 'Which Celebrity Punches The Hardest?', 'duration': datetime.timedelta(seconds=47), 'duration_readable': datetime.timedelta(seconds=47), 'view_count': 58888333, 'like_count': 1662388, 'comment_count': 4854, 'published_at': datetime.date(2025, 9, 19)}]\n(Background on this error at: https://sqlalche.me/e/14/gkpj)","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/Users/meissagningue/Projects/dev_ia/pipeline_etl_youtube/.venv/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":920,"name":"run"},{"filename":"/Users/meissagningue/Projects/dev_ia/pipeline_etl_youtube/.venv/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1215,"name":"_execute_task"},{"filename":"/Users/meissagningue/Projects/dev_ia/pipeline_etl_youtube/.venv/lib/python3.11/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/Users/meissagningue/Projects/dev_ia/pipeline_etl_youtube/.venv/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":216,"name":"execute"},{"filename":"/Users/meissagningue/Projects/dev_ia/pipeline_etl_youtube/.venv/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":239,"name":"execute_callable"},{"filename":"/Users/meissagningue/Projects/dev_ia/pipeline_etl_youtube/.venv/lib/python3.11/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/Users/meissagningue/Projects/dev_ia/pipeline_etl_youtube/dags/update_db.py","lineno":128,"name":"load_core"},{"filename":"/Users/meissagningue/Projects/dev_ia/pipeline_etl_youtube/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py","lineno":1385,"name":"execute"},{"filename":"/Users/meissagningue/Projects/dev_ia/pipeline_etl_youtube/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py","lineno":334,"name":"_execute_on_connection"},{"filename":"/Users/meissagningue/Projects/dev_ia/pipeline_etl_youtube/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py","lineno":1577,"name":"_execute_clauseelement"},{"filename":"/Users/meissagningue/Projects/dev_ia/pipeline_etl_youtube/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py","lineno":1953,"name":"_execute_context"},{"filename":"/Users/meissagningue/Projects/dev_ia/pipeline_etl_youtube/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py","lineno":2134,"name":"_handle_dbapi_exception"},{"filename":"/Users/meissagningue/Projects/dev_ia/pipeline_etl_youtube/.venv/lib/python3.11/site-packages/sqlalchemy/util/compat.py","lineno":211,"name":"raise_"},{"filename":"/Users/meissagningue/Projects/dev_ia/pipeline_etl_youtube/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py","lineno":1910,"name":"_execute_context"},{"filename":"/Users/meissagningue/Projects/dev_ia/pipeline_etl_youtube/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py","lineno":736,"name":"do_execute"}],"is_group":false,"exceptions":[]},{"exc_type":"UniqueViolation","exc_value":"duplicate key value violates unique constraint \"youtube_videos_video_id_key\"\nDETAIL:  Key (video_id)=(9Xeepzg1B8I) already exists.\n","exc_notes":[],"syntax_error":null,"is_cause":true,"frames":[{"filename":"/Users/meissagningue/Projects/dev_ia/pipeline_etl_youtube/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py","lineno":1910,"name":"_execute_context"},{"filename":"/Users/meissagningue/Projects/dev_ia/pipeline_etl_youtube/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py","lineno":736,"name":"do_execute"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-09-26T14:36:20.682561Z","level":"info","event":"Task instance in failure state","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-26T14:36:20.683697Z","level":"info","event":"Task start","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-26T14:36:20.683933Z","level":"info","event":"Task:<Task(PythonOperator): load_core>","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-26T14:36:20.684083Z","level":"info","event":"Failure caused by (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"youtube_videos_video_id_key\"","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-26T14:36:20.684242Z","level":"info","event":"DETAIL:  Key (video_id)=(9Xeepzg1B8I) already exists.","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-26T14:36:20.684383Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-26T14:36:20.684475Z","level":"info","event":"[SQL: INSERT INTO youtube_videos (channel_handle, extraction_date, video_id, title, duration, duration_readable, view_count, like_count, comment_count, published_at) VALUES (%(channel_handle)s, %(extraction_date)s, %(video_id)s, %(title)s, %(duration)s, %(duration_readable)s, %(view_count)s, %(like_count)s, %(comment_count)s, %(published_at)s) RETURNING youtube_videos.id]","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-26T14:36:20.684643Z","level":"info","event":"[parameters: {'channel_handle': 'MrBeast', 'extraction_date': datetime.date(2025, 9, 22), 'video_id': '9Xeepzg1B8I', 'title': 'Which Celebrity Punches The Hardest?', 'duration': datetime.timedelta(seconds=47), 'duration_readable': datetime.timedelta(seconds=47), 'view_count': 58888333, 'like_count': 1662388, 'comment_count': 4854, 'published_at': datetime.date(2025, 9, 19)}]","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-26T14:36:20.684735Z","level":"info","event":"(Background on this error at: https://sqlalche.me/e/14/gkpj)","chan":"stdout","logger":"task"}
